<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hq.acdm.dao.statistics.AverageCrossingTimeMapper" >
  <resultMap id="BaseResultMap" type="com.hq.acdm.model.statistics.averageCrossingTime.AverageCrossingTime" >
    <result column="queryDate" property="queryDate" jdbcType="TIMESTAMP" />
    <result column="AIRLINE_CODE_IATA" property="airline_code_iata" jdbcType="VARCHAR" />
    <result column="AIRPORTTYPE" property="airport_type" jdbcType="VARCHAR" />
    <result column="AVGTime" property="averageTime" jdbcType="INTEGER" />
  </resultMap>
  <select id="queryAverageCrossingTime" parameterType="map" resultType="com.hq.acdm.model.statistics.averageCrossingTime.AverageCrossingTime"  >
      select sobt_date,AIRLINE_CODE_IATA,AIRPORTTYPE,SUM(PASS_STAND_TIME) as pstt,
      AVG(PASS_STAND_TIME) as avgpst,COUNT(*) as total from V_PASS_STAND_TIME WHERE 1=1
      <if test="params.startDate != null and params.startDate != ''" >
       and to_char(sobt,'yyyy-mm-dd hh24:mi:ss')&gt;=#{params.startDate}
      </if>
      <if test="params.endDate != null and params.endDate != ''">
          and to_char(sobt,'yyyy-mm-dd hh24:mi:ss')&lt;=#{params.endDate}

      </if>
      <if test="params.planeModel !=null and params.planeModel != ''">
          and AIRPORTTYPE=#{params.planeModel}
      </if>
      <if test="params.airCompany !=null and params.airCompany != ''">
          and AIRLINE_CODE_IATA=#{params.airCompany}
      </if>
      GROUP BY AIRLINE_CODE_IATA,AIRPORTTYPE,sobt_date
  </select>
</mapper>