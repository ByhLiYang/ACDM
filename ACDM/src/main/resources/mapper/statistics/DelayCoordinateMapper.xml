<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hq.acdm.dao.statistics.DelayCoordinateMapper" >
    <select id="queryDelay" resultType="com.hq.acdm.model.statistics.delayCoordinate.DelayCoordinateModel">
       select * from V_DELAY_FLI_NO AA LEFT JOIN DAILY_FLIGHT_MASTER BB
        on
        TO_CHAR(BB.OPERATIONAL_DATE,'YYYY-MM-DD') = TO_CHAR(AA.OPERATIONAL_DATE,'YYYY-MM-DD')
        AND BB.A_OR_D = AA.A_OR_D
        AND BB.FLIGHT_NO_IATA = AA.FLIGHT_NO_IATA
        LEFT JOIN DAILY_FLIGHT_ADD_DETAILS CC
        ON
        TO_CHAR(BB.OPERATIONAL_DATE,'YYYY-MM-DD') = TO_CHAR(CC.OPERATIONAL_DATE,'YYYY-MM-DD')
        AND BB.A_OR_D = CC.A_OR_D
        AND BB.FLIGHT_NO_IATA = CC.FLIGHT_NO_IATA
        LEFT JOIN DAILY_FLIGHT_ADD_DETAILS_MORE DD
        ON
        TO_CHAR(BB.OPERATIONAL_DATE,'YYYY-MM-DD') = TO_CHAR(DD.OPERATIONAL_DATE,'YYYY-MM-DD')
        AND BB.A_OR_D = DD.A_OR_D
        AND BB.FLIGHT_NO_IATA = DD.FLIGHT_NO_IATA

    </select>

</mapper>